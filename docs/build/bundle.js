var app=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n(t,e){return n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(t,e)}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,n){if(n&&("object"===i(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return e(t)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(t,e)||u(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||u(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t)););return t}function f(){return f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=h(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},f.apply(this,arguments)}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e,n){return e&&v(t.prototype,e),n&&v(t,n),t}function y(){}function p(t){return t()}function g(){return Object.create(null)}function m(t){t.forEach(p)}function x(t){return"function"==typeof t}function k(t,e){return t!=t?e==e:t!==e||t&&"object"===i(t)||"function"==typeof t}function E(t,e){t.appendChild(e)}function R(t,e,n){t.insertBefore(e,n||null)}function C(t){t.parentNode.removeChild(t)}function b(t){return document.createElement(t)}function S(t){return document.createTextNode(t)}function T(){return S(" ")}function w(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function A(t){return Array.from(t.childNodes)}function M(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}var _;function O(t){_=t}function P(t){(function(){if(!_)throw new Error("Function called outside component initialization");return _})().$$.on_mount.push(t)}var I=[],B=[],L=[],N=[],U=Promise.resolve(),F=!1;function D(t){L.push(t)}function $(t){N.push(t)}var j=!1,X=new Set;function Y(){if(!j){j=!0;do{for(var t=0;t<I.length;t+=1){var e=I[t];O(e),z(e.$$)}for(O(null),I.length=0;B.length;)B.pop()();for(var n=0;n<L.length;n+=1){var r=L[n];X.has(r)||(X.add(r),r())}L.length=0}while(I.length);for(;N.length;)N.pop()();F=!1,j=!1,X.clear()}}function z(t){if(null!==t.fragment){t.update(),m(t.before_update);var e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(D)}}var W=new Set;function q(t,e){t&&t.i&&(W.delete(t),t.i(e))}function V(t,e,n){var r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function G(t,e,n,r){var i=t.$$,o=i.fragment,a=i.on_mount,s=i.on_destroy,u=i.after_update;o&&o.m(e,n),r||D((function(){var e=a.map(p).filter(x);s?s.push.apply(s,l(e)):m(e),t.$$.on_mount=[]})),u.forEach(D)}function K(t,e){var n=t.$$;null!==n.fragment&&(m(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function H(t,e){-1===t.$$.dirty[0]&&(I.push(t),F||(F=!0,U.then(Y)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Z(t,e,n,r,i,o,a){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[-1],u=_;O(t);var c=t.$$={fragment:null,ctx:null,props:o,update:y,not_equal:i,bound:g(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:g(),dirty:s,skip_bound:!1,root:e.target||u.$$.root};a&&a(c.root);var l=!1;if(c.ctx=n?n(t,e.props||{},(function(e,n){var r=!(arguments.length<=2)&&arguments.length-2?arguments.length<=2?void 0:arguments[2]:n;return c.ctx&&i(c.ctx[e],c.ctx[e]=r)&&(!c.skip_bound&&c.bound[e]&&c.bound[e](r),l&&H(t,e)),n})):[],c.update(),l=!0,m(c.before_update),c.fragment=!!r&&r(c.ctx),e.target){if(e.hydrate){var h=A(e.target);c.fragment&&c.fragment.l(h),h.forEach(C)}else c.fragment&&c.fragment.c();e.intro&&q(t.$$.fragment),G(t,e.target,e.anchor,e.customElement),Y()}O(u)}var J=function(){function e(){t(this,e)}return d(e,[{key:"$destroy",value:function(){K(this,1),this.$destroy=y}},{key:"$on",value:function(t,e){var n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}}},{key:"$set",value:function(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}]),e}();function Q(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}var tt={};function et(t){return Math.round(t/tt.EPSILON)*tt.EPSILON}function nt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.precision,r=void 0===n?tt.precision||4:n;return t=et(t),"".concat(parseFloat(t.toPrecision(r)))}function rt(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function it(t,e,n){var r=tt.EPSILON;n&&(tt.EPSILON=n);try{if(t===e)return!0;if(rt(t)&&rt(e)){if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(!it(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=tt.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{tt.EPSILON=r}}function ot(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}tt.EPSILON=1e-12,tt.debug=!1,tt.precision=4,tt.printTypes=!1,tt.printDegrees=!1,tt.printRowMajor=!0;var at=function(e){r(i,e);var n=ot(i);function i(){return t(this,i),n.apply(this,arguments)}return d(i,[{key:"ELEMENTS",get:function(){return Q(!1),0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"from",value:function(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}},{key:"to",value:function(t){return t===this?this:rt(t)?this.toArray(t):this.toObject(t)}},{key:"toTarget",value:function(t){return t?this.to(t):this}},{key:"toArray",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"toString",value:function(){return this.formatString(tt)}},{key:"formatString",value:function(t){for(var e="",n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+nt(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}},{key:"equals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!it(this[e],t[e]))return!1;return!0}},{key:"exactEquals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:"negate",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:"lerp",value:function(t,e,n){void 0===n&&(n=e,e=t,t=this);for(var r=0;r<this.ELEMENTS;++r){var i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}},{key:"min",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:"max",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:"clamp",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var o=i[r],a=0;a<this.ELEMENTS;++a)this[a]+=o[a];return this.check()}},{key:"subtract",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var o=i[r],a=0;a<this.ELEMENTS;++a)this[a]-=o[a];return this.check()}},{key:"scale",value:function(t){if(Array.isArray(t))return this.multiply(t);for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"sub",value:function(t){return this.subtract(t)}},{key:"setScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:"addScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:"subScalar",value:function(t){return this.addScalar(-t)}},{key:"multiplyScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"divideScalar",value:function(t){return this.scale(1/t)}},{key:"clampScalar",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}},{key:"multiplyByScalar",value:function(t){return this.scale(t)}},{key:"elements",get:function(){return this}},{key:"check",value:function(){if(tt.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"validate",value:function(){for(var t=this.length===this.ELEMENTS,e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}}]),i}(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array));function st(t,e){if(t.length!==e)return!1;for(var n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function ut(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function ct(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(tt.debug&&!st(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}var lt={};function ht(t,e){lt[t]||(lt[t]=!0,console.warn("".concat(t," has been removed in version ").concat(e,", see upgrade guide for more information")))}function ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}var vt,dt=function(e){r(i,e);var n=ft(i);function i(){return t(this,i),n.apply(this,arguments)}return d(i,[{key:"ELEMENTS",get:function(){return Q(!1),0}},{key:"copy",value:function(t){return Q(!1),this}},{key:"x",get:function(){return this[0]},set:function(t){this[0]=ut(t)}},{key:"y",get:function(){return this[1]},set:function(t){this[1]=ut(t)}},{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return this.len()}},{key:"lengthSquared",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:"magnitudeSquared",value:function(){return this.lengthSquared()}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:"distanceSquared",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n){var r=this[n]-t[n];e+=r*r}return ut(e)}},{key:"dot",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return ut(e)}},{key:"normalize",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:"multiply",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var o=i[r],a=0;a<this.ELEMENTS;++a)this[a]*=o[a];return this.check()}},{key:"divide",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var o=i[r],a=0;a<this.ELEMENTS;++a)this[a]/=o[a];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(t){return this.distance(t)}},{key:"distanceToSquared",value:function(t){return this.distanceSquared(t)}},{key:"getComponent",value:function(t){return Q(t>=0&&t<this.ELEMENTS,"index is out of range"),ut(this[t])}},{key:"setComponent",value:function(t,e){return Q(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}},{key:"addVectors",value:function(t,e){return this.copy(t).add(e)}},{key:"subVectors",value:function(t,e){return this.copy(t).subtract(e)}},{key:"multiplyVectors",value:function(t,e){return this.copy(t).multiply(e)}},{key:"addScaledVector",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}]),i}(at),yt=1e-6,pt="undefined"!=typeof Float32Array?Float32Array:Array;function gt(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o||1;return t[0]=(n[0]*r+n[4]*i+n[8]*o)/a,t[1]=(n[1]*r+n[5]*i+n[9]*o)/a,t[2]=(n[2]*r+n[6]*i+n[10]*o)/a,t}function mt(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function xt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)}),vt=new pt(2),pt!=Float32Array&&(vt[0]=0,vt[1]=0),function(){var t=function(){var t=new pt(3);return pt!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}();var kt=[0,0,0],Et={},Rt=function(e){r(i,e);var n=xt(i);function i(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t(this,i),e=n.call(this,-0,-0,-0),1===arguments.length&&rt(r)?e.copy(r):(tt.debug&&(ut(r),ut(o),ut(a)),e[0]=r,e[1]=o,e[2]=a),e}return d(i,[{key:"set",value:function(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}},{key:"fromObject",value:function(t){return tt.debug&&(ut(t.x),ut(t.y),ut(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}},{key:"toObject",value:function(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(t){this[2]=ut(t)}},{key:"angle",value:function(t){return n=t,r=(e=this)[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],c=Math.sqrt(r*r+i*i+o*o)*Math.sqrt(a*a+s*s+u*u),l=c&&function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}(e,n)/c,Math.acos(Math.min(Math.max(l,-1),1));var e,n,r,i,o,a,s,u,c,l}},{key:"cross",value:function(t){return function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a}(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e=t.radians,n=t.origin;return function(t,e,n,r){var i=[],o=[];i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,void 0===n?kt:n,e),this.check()}},{key:"rotateY",value:function(t){var e=t.radians,n=t.origin;return function(t,e,n,r){var i=[],o=[];i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,void 0===n?kt:n,e),this.check()}},{key:"rotateZ",value:function(t){var e=t.radians,n=t.origin;return function(t,e,n,r){var i=[],o=[];i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,void 0===n?kt:n,e),this.check()}},{key:"transform",value:function(t){return this.transformAsPoint(t)}},{key:"transformAsPoint",value:function(t){return mt(this,this,t),this.check()}},{key:"transformAsVector",value:function(t){return gt(this,this,t),this.check()}},{key:"transformByMatrix3",value:function(t){return function(t,e,n){var r=e[0],i=e[1],o=e[2];t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8]}(this,this,t),this.check()}},{key:"transformByMatrix2",value:function(t){return function(t,e,n){var r=e[0],i=e[1];t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2]}(this,this,t),this.check()}},{key:"transformByQuaternion",value:function(t){return function(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],l=i*c-o*u,h=o*s-r*c,f=r*u-i*s,v=i*f-o*h,d=o*l-r*f,y=r*h-i*l,p=2*a;l*=p,h*=p,f*=p,v*=2,d*=2,y*=2,t[0]=s+l+v,t[1]=u+h+d,t[2]=c+f+y}(this,this,t),this.check()}}],[{key:"ZERO",get:function(){return Et.ZERO=Et.ZERO||Object.freeze(new i(0,0,0,0))}}]),i}(dt);function Ct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}var bt=function(e){r(i,e);var n=Ct(i);function i(){return t(this,i),n.apply(this,arguments)}return d(i,[{key:"ELEMENTS",get:function(){return Q(!1),0}},{key:"RANK",get:function(){return Q(!1),0}},{key:"toString",value:function(){var t="[";if(tt.printRowMajor){t+="row-major:";for(var e=0;e<this.RANK;++e)for(var n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(var r=0;r<this.ELEMENTS;++r)t+=" ".concat(this[r])}return t+="]"}},{key:"getElementIndex",value:function(t,e){return e*this.RANK+t}},{key:"getElement",value:function(t,e){return this[e*this.RANK+t]}},{key:"setElement",value:function(t,e,n){return this[e*this.RANK+t]=ut(n),this}},{key:"getColumn",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0),n=t*this.RANK,r=0;r<this.RANK;++r)e[r]=this[n+r];return e}},{key:"setColumn",value:function(t,e){for(var n=t*this.RANK,r=0;r<this.RANK;++r)this[n+r]=e[r];return this}}]),i}(at);function St(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],v=e[10],d=e[11],y=e[12],p=e[13],g=e[14],m=e[15],x=n[0],k=n[1],E=n[2],R=n[3];return t[0]=x*r+k*s+E*h+R*y,t[1]=x*i+k*u+E*f+R*p,t[2]=x*o+k*c+E*v+R*g,t[3]=x*a+k*l+E*d+R*m,x=n[4],k=n[5],E=n[6],R=n[7],t[4]=x*r+k*s+E*h+R*y,t[5]=x*i+k*u+E*f+R*p,t[6]=x*o+k*c+E*v+R*g,t[7]=x*a+k*l+E*d+R*m,x=n[8],k=n[9],E=n[10],R=n[11],t[8]=x*r+k*s+E*h+R*y,t[9]=x*i+k*u+E*f+R*p,t[10]=x*o+k*c+E*v+R*g,t[11]=x*a+k*l+E*d+R*m,x=n[12],k=n[13],E=n[14],R=n[15],t[12]=x*r+k*s+E*h+R*y,t[13]=x*i+k*u+E*f+R*p,t[14]=x*o+k*c+E*v+R*g,t[15]=x*a+k*l+E*d+R*m,t}function Tt(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function wt(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function At(t,e,n,r){var i,o,a,s,u,c,l,h,f,v,d=e[0],y=e[1],p=e[2],g=r[0],m=r[1],x=r[2],k=n[0],E=n[1],R=n[2];return Math.abs(d-k)<yt&&Math.abs(y-E)<yt&&Math.abs(p-R)<yt?function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(t):(l=d-k,h=y-E,f=p-R,i=m*(f*=v=1/Math.hypot(l,h,f))-x*(h*=v),o=x*(l*=v)-g*f,a=g*h-m*l,(v=Math.hypot(i,o,a))?(i*=v=1/v,o*=v,a*=v):(i=0,o=0,a=0),s=h*a-f*o,u=f*i-l*a,c=l*o-h*i,(v=Math.hypot(s,u,c))?(s*=v=1/v,u*=v,c*=v):(s=0,u=0,c=0),t[0]=i,t[1]=s,t[2]=l,t[3]=0,t[4]=o,t[5]=u,t[6]=h,t[7]=0,t[8]=a,t[9]=c,t[10]=f,t[11]=0,t[12]=-(i*d+o*y+a*p),t[13]=-(s*d+u*y+c*p),t[14]=-(l*d+h*y+f*p),t[15]=1,t)}function Mt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}!function(){var t=function(){var t=new pt(4);return pt!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();var _t=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Ot=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Pt=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),It={},Bt=function(e){r(i,e);var n=Mt(i);function i(e){var r;return t(this,i),r=n.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?r.copy(e):r.identity(),r}return d(i,[{key:"INDICES",get:function(){return Pt}},{key:"ELEMENTS",get:function(){return 16}},{key:"RANK",get:function(){return 4}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}},{key:"set",value:function(t,e,n,r,i,o,a,s,u,c,l,h,f,v,d,y){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=a,this[7]=s,this[8]=u,this[9]=c,this[10]=l,this[11]=h,this[12]=f,this[13]=v,this[14]=d,this[15]=y,this.check()}},{key:"setRowMajor",value:function(t,e,n,r,i,o,a,s,u,c,l,h,f,v,d,y){return this[0]=t,this[1]=i,this[2]=u,this[3]=f,this[4]=e,this[5]=o,this[6]=c,this[7]=v,this[8]=n,this[9]=a,this[10]=l,this[11]=d,this[12]=r,this[13]=s,this[14]=h,this[15]=y,this.check()}},{key:"toRowMajor",value:function(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}},{key:"identity",value:function(){return this.copy(_t)}},{key:"fromQuaternion",value:function(t){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,h=r*s,f=i*a,v=i*s,d=i*u,y=o*a,p=o*s,g=o*u;t[0]=1-h-d,t[1]=l+g,t[2]=f-p,t[3]=0,t[4]=l-g,t[5]=1-c-d,t[6]=v+y,t[7]=0,t[8]=f+p,t[9]=v-y,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this.check()}},{key:"frustum",value:function(t){var e=t.left,n=t.right,r=t.bottom,o=t.top,a=t.near,s=t.far;return s===1/0?i._computeInfinitePerspectiveOffCenter(this,e,n,r,o,a):function(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),c=1/(o-a);t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0}(this,e,n,r,o,a,s),this.check()}},{key:"lookAt",value:function(t,e,n){if(1===arguments.length){var r=t;t=r.eye,e=r.center,n=r.up}return At(this,t,e=e||[0,0,0],n=n||[0,1,0]),this.check()}},{key:"ortho",value:function(t){var e=t.left,n=t.right,r=t.bottom,i=t.top,o=t.near,a=void 0===o?.1:o,s=t.far;return function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1}(this,e,n,r,i,a,void 0===s?500:s),this.check()}},{key:"orthographic",value:function(t){var e=t.fovy,n=void 0===e?45*Math.PI/180:e,r=t.aspect,o=void 0===r?1:r,a=t.focalDistance,s=void 0===a?1:a,u=t.near,c=void 0===u?.1:u,l=t.far,h=void 0===l?500:l;if(n>2*Math.PI)throw Error("radians");var f=n/2,v=s*Math.tan(f),d=v*o;return(new i).ortho({left:-d,right:d,bottom:-v,top:v,near:c,far:h})}},{key:"perspective",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.fovy,n=void 0===e?void 0:e,r=t.fov,i=void 0===r?45*Math.PI/180:r,o=t.aspect,a=void 0===o?1:o,s=t.near,u=void 0===s?.1:s,c=t.far,l=void 0===c?500:c;if((n=n||i)>2*Math.PI)throw Error("radians");return wt(this,n,a,u,l),this.check()}},{key:"determinant",value:function(){return e=(t=this)[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],h=t[10],f=t[11],v=t[12],d=t[13],y=t[14],p=t[15],(e*a-n*o)*(h*p-f*y)-(e*s-r*o)*(l*p-f*d)+(e*u-i*o)*(l*y-h*d)+(n*s-r*a)*(c*p-f*v)-(n*u-i*a)*(c*y-h*v)+(r*u-i*s)*(c*d-l*v);var t,e,n,r,i,o,a,s,u,c,l,h,f,v,d,y,p}},{key:"getScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}},{key:"getTranslation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}},{key:"getRotation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*i,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*i,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{key:"getRotationMatrix3",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=this[4]*r,t[4]=this[5]*i,t[5]=this[6]*o,t[6]=this[8]*r,t[7]=this[9]*i,t[8]=this[10]*o,t}},{key:"transpose",value:function(){return function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}},{key:"invert",value:function(){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],v=e[11],d=e[12],y=e[13],p=e[14],g=e[15],m=n*s-r*a,x=n*u-i*a,k=n*c-o*a,E=r*u-i*s,R=r*c-o*s,C=i*c-o*u,b=l*y-h*d,S=l*p-f*d,T=l*g-v*d,w=h*p-f*y,A=h*g-v*y,M=f*g-v*p,_=m*M-x*A+k*w+E*T-R*S+C*b;_&&(_=1/_,t[0]=(s*M-u*A+c*w)*_,t[1]=(i*A-r*M-o*w)*_,t[2]=(y*C-p*R+g*E)*_,t[3]=(f*R-h*C-v*E)*_,t[4]=(u*T-a*M-c*S)*_,t[5]=(n*M-i*T+o*S)*_,t[6]=(p*k-d*C-g*x)*_,t[7]=(l*C-f*k+v*x)*_,t[8]=(a*A-s*T+c*b)*_,t[9]=(r*T-n*A-o*b)*_,t[10]=(d*R-y*k+g*m)*_,t[11]=(h*k-l*R-v*m)*_,t[12]=(s*S-a*w-u*b)*_,t[13]=(n*w-r*S+i*b)*_,t[14]=(y*x-d*E-p*m)*_,t[15]=(l*E-h*x+f*m)*_)}(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return St(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return St(this,this,t),this.check()}},{key:"rotateX",value:function(t){return function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],h=e[10],f=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+h*r,t[7]=u*i+f*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=h*i-s*r,t[11]=f*i-u*r}(this,this,t),this.check()}},{key:"rotateY",value:function(t){return function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],l=e[9],h=e[10],f=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=s*i-h*r,t[3]=u*i-f*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=s*r+h*i,t[11]=u*r+f*i}(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],h=e[6],f=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+h*r,t[3]=u*i+f*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=h*i-s*r,t[7]=f*i-u*r}(this,this,t),this.check()}},{key:"rotateXYZ",value:function(t){var e=c(t,3),n=e[0],r=e[1],i=e[2];return this.rotateX(n).rotateY(r).rotateZ(i)}},{key:"rotateAxis",value:function(t,e){return function(t,e,n,r){var i,o,a,s,u,c,l,h,f,v,d,y,p,g,m,x,k,E,R,C,b,S,T,w,A=r[0],M=r[1],_=r[2],O=Math.hypot(A,M,_);O<yt||(A*=O=1/O,M*=O,_*=O,i=Math.sin(n),a=1-(o=Math.cos(n)),s=e[0],u=e[1],c=e[2],l=e[3],h=e[4],f=e[5],v=e[6],d=e[7],y=e[8],p=e[9],g=e[10],m=e[11],x=A*A*a+o,k=M*A*a+_*i,E=_*A*a-M*i,R=A*M*a-_*i,C=M*M*a+o,b=_*M*a+A*i,S=A*_*a+M*i,T=M*_*a-A*i,w=_*_*a+o,t[0]=s*x+h*k+y*E,t[1]=u*x+f*k+p*E,t[2]=c*x+v*k+g*E,t[3]=l*x+d*k+m*E,t[4]=s*R+h*C+y*b,t[5]=u*R+f*C+p*b,t[6]=c*R+v*C+g*b,t[7]=l*R+d*C+m*b,t[8]=s*S+h*T+y*w,t[9]=u*S+f*T+p*w,t[10]=c*S+v*T+g*w,t[11]=l*S+d*T+m*w,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?Tt(this,this,t):Tt(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){return function(t,e,n){var r,i,o,a,s,u,c,l,h,f,v,d,y=n[0],p=n[1],g=n[2];e===t?(t[12]=e[0]*y+e[4]*p+e[8]*g+e[12],t[13]=e[1]*y+e[5]*p+e[9]*g+e[13],t[14]=e[2]*y+e[6]*p+e[10]*g+e[14],t[15]=e[3]*y+e[7]*p+e[11]*g+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],v=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=f,t[10]=v,t[11]=d,t[12]=r*y+s*p+h*g+e[12],t[13]=i*y+u*p+f*g+e[13],t[14]=o*y+c*p+v*g+e[14],t[15]=a*y+l*p+d*g+e[15])}(this,this,t),this.check()}},{key:"transform",value:function(t,e){return 4===t.length?(e=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}(e||[-0,-0,-0,-0],t,this),ct(e,4),e):this.transformAsPoint(t,e)}},{key:"transformAsPoint",value:function(t,e){switch(t.length){case 2:e=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(e||[-0,-0],t,this);break;case 3:e=mt(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return ct(e,t.length),e}},{key:"transformAsVector",value:function(t,e){switch(t.length){case 2:e=function(t,e,n){var r=e[0],i=e[1],o=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/o,t[1]=(n[1]*r+n[5]*i)/o,t}(e||[-0,-0],t,this);break;case 3:e=gt(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return ct(e,t.length),e}},{key:"makeRotationX",value:function(t){return this.identity().rotateX(t)}},{key:"makeTranslation",value:function(t,e,n){return this.identity().translate([t,e,n])}},{key:"transformPoint",value:function(t,e){return ht("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}},{key:"transformVector",value:function(t,e){return ht("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}},{key:"transformDirection",value:function(t,e){return ht("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}],[{key:"IDENTITY",get:function(){return It.IDENTITY=It.IDENTITY||Object.freeze(new i(_t)),It.IDENTITY}},{key:"ZERO",get:function(){return It.ZERO=It.ZERO||Object.freeze(new i(Ot)),It.ZERO}},{key:"_computeInfinitePerspectiveOffCenter",value:function(t,e,n,r,i,o){var a=2*o/(n-e),s=2*o/(i-r),u=(n+e)/(n-e),c=(i+r)/(i-r),l=-2*o;return t[0]=a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=u,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0,t}}]),i}(bt),Lt=function(){function e(){t(this,e),this.Start=this.Start.bind(this),this.Update=this.Update.bind(this),this.Render=this.Render.bind(this)}return d(e,[{key:"Start",value:function(){}},{key:"Update",value:function(){}},{key:"Render",value:function(){}}]),e}();function Nt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}var Ut=function(n){r(o,n);var i=Nt(o);function o(){var n;return t(this,o),(n=i.call(this)).world=null,n.parent=null,n.glContext=null,n.program=null,n.verticies=[],n.vertexBuffer=null,n.vertexAttrLocation=null,n.indices=[],n.indexBuffer=null,n.mvpUniformLocation=null,n.position=new Rt,n.angle=0,n.scale=new Rt(1,1,1),n.transform=(new Bt).identity(),n.zOrder=0,n.SetWorld=n.SetWorld.bind(e(n)),n.InitMesh=n.InitMesh.bind(e(n)),n.Translate=n.Translate.bind(e(n)),n.TranslateX=n.TranslateX.bind(e(n)),n.TranslateY=n.TranslateY.bind(e(n)),n.Rotate=n.Rotate.bind(e(n)),n.Scale=n.Scale.bind(e(n)),n.ScaleX=n.ScaleX.bind(e(n)),n.ScaleY=n.ScaleY.bind(e(n)),n.SetZOrder=n.SetZOrder.bind(e(n)),n.CalculateTransform=n.CalculateTransform.bind(e(n)),n._SetRenderAttributes=n._SetRenderAttributes.bind(e(n)),n._Draw=n._Draw.bind(e(n)),n.Release=n.Release.bind(e(n)),n}return d(o,[{key:"SetWorld",value:function(t){this.world=t}},{key:"SetParent",value:function(t){this.parent=t}},{key:"InitMesh",value:function(t){this.glContext=t,this.verticies.length&&this.indices.length&&this.program&&(this.vertexAttrLocation=this.glContext.getAttribLocation(this.program,"vPosition"),this.vertexBuffer=this.glContext.createBuffer(),this.glContext.bindBuffer(this.glContext.ARRAY_BUFFER,this.vertexBuffer),this.glContext.bufferData(this.glContext.ARRAY_BUFFER,new Float32Array(this.verticies),this.glContext.STATIC_DRAW),this.indexBuffer=this.glContext.createBuffer(),this.glContext.bindBuffer(this.glContext.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.glContext.bufferData(this.glContext.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indices),this.glContext.STATIC_DRAW),this.mvpUniformLocation=this.glContext.getUniformLocation(this.program,"MVP"))}},{key:"Translate",value:function(t){if(t.constructor==Rt)throw new TypeError("newPosition is not Vector3!");this.position=t}},{key:"TranslateX",value:function(t){this.position.x=t}},{key:"TranslateY",value:function(t){this.position.y=t}},{key:"Rotate",value:function(t){this.angle=t}},{key:"Scale",value:function(t){if(t.constructor==Rt)throw new TypeError("newPosition is not Vector3!");this.scale=t}},{key:"ScaleX",value:function(t){this.scale.x=t}},{key:"ScaleY",value:function(t){this.scale.y=t}},{key:"SetZOrder",value:function(t){this.zOrder=t}},{key:"Start",value:function(){f(a(o.prototype),"Start",this).call(this)}},{key:"Update",value:function(){f(a(o.prototype),"Update",this).call(this)}},{key:"Render",value:function(){f(a(o.prototype),"Render",this).call(this),this._SetRenderAttributes(),this._Draw()}},{key:"Release",value:function(){this.vertexBuffer&&this.glContext.deleteBuffer(this.vertexBuffer),this.indexBuffer&&this.glContext.deleteBuffer(this.indexBuffer),this.program&&this.glContext.deleteProgram(this.program)}},{key:"_SetRenderAttributes",value:function(){if(this.program&&this.glContext&&this.world){this.glContext.useProgram(this.program),this.glContext.bindBuffer(this.glContext.ARRAY_BUFFER,this.vertexBuffer),this.glContext.enableVertexAttribArray(this.vertexAttrLocation);this.glContext.vertexAttribPointer(this.vertexAttrLocation,3,this.glContext.FLOAT,!1,0,0);var t=this.world.projectionMatrix.clone(),e=this.world.camera.CalculateTransform().clone(),n=this.CalculateTransform().clone(),r=t.multiplyRight(e.multiplyRight(n));this.glContext.uniformMatrix4fv(this.mvpUniformLocation,!1,r)}}},{key:"_Draw",value:function(){this.program&&this.glContext&&this.world&&(this.glContext.bindBuffer(this.glContext.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.glContext.drawElements(this.glContext.TRIANGLES,this.indices.length,this.glContext.UNSIGNED_SHORT,0))}},{key:"CalculateTransform",value:function(){var t=(new Bt).identity();if(t=(t=(t=t.translate(this.position)).rotateZ(this.angle)).scale(this.scale),this.parent){var e=this.parent.CalculateTransform().clone();this.transform=e.multiplyRight(t)}else this.transform=t;return this.transform}}]),o}(Lt);function Ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}var Dt=function(n){r(o,n);var i=Ft(o);function o(){var n;return t(this,o),(n=i.call(this)).position.z=2,n.upVector=new Rt(0,1,0),n.viewMatrix=new Bt,n.CalculateTransform=n.CalculateTransform.bind(e(n)),n}return d(o,[{key:"CalculateTransform",value:function(){return this.viewMatrix=(new Bt).rotateZ(this.angle).invert().multiplyRight((new Bt).translate(this.position).invert()),this.viewMatrix}}]),o}(Ut),$t=function(){function e(n,r,i){t(this,e),this.glContext=n,this.rawVertexShader=r,this.rawFragShader=i,this.vertexShader=null,this.fragShader=null,this.program=null,this.CompileShader=this.CompileShader.bind(this),this.CreateShader=this.CreateShader.bind(this),this.CreateProgram=this.CreateProgram.bind(this)}return d(e,[{key:"CompileShader",value:function(){this.vertexShader=this.CreateShader(this.glContext.VERTEX_SHADER,this.rawVertexShader),this.fragShader=this.CreateShader(this.glContext.FRAGMENT_SHADER,this.rawFragShader),this.program=this.CreateProgram()}},{key:"CreateShader",value:function(t,e){var n=this.glContext.createShader(t);if(this.glContext.shaderSource(n,e),this.glContext.compileShader(n),this.glContext.getShaderParameter(n,this.glContext.COMPILE_STATUS))return n;console.log(this.glContext.getShaderInfoLog(n)),this.glContext.deleteShader(n)}},{key:"CreateProgram",value:function(){var t=this.glContext.createProgram();if(this.glContext.attachShader(t,this.vertexShader),this.glContext.attachShader(t,this.fragShader),this.glContext.linkProgram(t),this.glContext.getProgramParameter(t,this.glContext.LINK_STATUS))return t;console.log(this.glContext.getProgramInfoLog(t)),this.glContext.deleteProgram(t)}}]),e}();function jt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}var Xt=function(e){r(i,e);var n=jt(i);function i(e){var r;return t(this,i),(r=n.call(this,e,"","")).rawVertexShader="\n        attribute vec4 vPosition;\n        attribute vec2 vTexCoord;\n\n        uniform mat4 MVP;\n\n        varying vec2 fTexCoord;\n        \n        void main() {\n        \n            gl_Position = MVP * vPosition;\n\n            fTexCoord = vTexCoord;\n        }\n        ",r.rawFragShader="\n        precision mediump float;\n\n        varying vec2 fTexCoord;\n        uniform sampler2D texture;\n        \n        void main() {\n            gl_FragColor = texture2D(texture, fTexCoord);\n        }\n        ",r.CompileShader(),r}return i}($t),Yt=function(){function e(){t(this,e),this.isMouseClick=!1,this.isRightMouseClick=!1,this.keyHold={},this.Initailize=this.Initailize.bind(this),this.Update=this.Update.bind(this)}return d(e,[{key:"Initailize",value:function(){var t=this;window.addEventListener("contextmenu",(function(t){t.preventDefault()})),window.addEventListener("mousedown",(function(e){0==e.button?t.isMouseClick=!0:2==e.button&&(t.isRightMouseClick=!0)})),window.addEventListener("mouseup",(function(e){0==e.button?t.isMouseClick=!1:2==e.button&&(t.isRightMouseClick=!1)})),window.addEventListener("keydown",(function(e){t.keyHold[e.key]=!0})),window.addEventListener("keyup",(function(e){t.keyHold[e.key]=!1}))}},{key:"Update",value:function(){}},{key:"IsMouseClick",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t?this.isRightMouseClick:this.isMouseClick}},{key:"IsKeyDown",value:function(t){return!!this.keyHold[t]&&this.keyHold[t]}}]),e}(),zt=function(){function e(){t(this,e),this.previousTime=0,this.deltaTime=0,this.Initailize=this.Initailize.bind(this),this.Update=this.Update.bind(this)}return d(e,[{key:"Initailize",value:function(){this.previousTime=Date.now(),this.deltaTime=0}},{key:"Update",value:function(){this.deltaTime=(Date.now()-this.previousTime)/1e3,this.previousTime=Date.now()}}]),e}();function Wt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return qt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function qt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Vt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}var Gt=function(n){r(o,n);var i=Vt(o);function o(){var n;return t(this,o),(n=i.call(this)).time=new zt,n.input=new Yt,n.stopTime=!1,n.projectionMatrix=null,n.glContext=null,n.entities=[],n.camera=new Dt,n.AddEntity=n.AddEntity.bind(e(n)),n.RemoveEntity=n.RemoveEntity.bind(e(n)),n.SortEntities=n.SortEntities.bind(e(n)),n.StopTime=n.StopTime.bind(e(n)),n.ResumeTime=n.ResumeTime.bind(e(n)),n}return d(o,[{key:"SetUp",value:function(t){this.glContext=t,this.projectionMatrix=(new Bt).orthographic({fovy:Math.PI/180*90,aspect:this.glContext.canvas.width/this.glContext.canvas.height,focalDistance:1,near:.1,far:100}),this.time.Initailize(),this.input.Initailize()}},{key:"Start",value:function(){f(a(o.prototype),"Start",this).call(this)}},{key:"Update",value:function(){f(a(o.prototype),"Update",this).call(this),this.stopTime||this.time.Update(),this.input.Update();var t,e=Wt(this.entities);try{for(e.s();!(t=e.n()).done;){t.value.Update()}}catch(t){e.e(t)}finally{e.f()}}},{key:"Render",value:function(){f(a(o.prototype),"Render",this).call(this),this.glContext.viewport(0,0,this.glContext.canvas.width,this.glContext.canvas.height),this.glContext.clearColor(0,0,0,0),this.glContext.clear(this.glContext.COLOR_BUFFER_BIT),this.glContext.enable(this.glContext.BLEND),this.glContext.blendFunc(this.glContext.SRC_ALPHA,this.glContext.ONE_MINUS_SRC_ALPHA),this.glContext.enable(this.glContext.CULL_FACE);var t,e=Wt(this.entities);try{for(e.s();!(t=e.n()).done;){t.value.Render()}}catch(t){e.e(t)}finally{e.f()}}},{key:"AddEntity",value:function(t){t.SetWorld(this),t.InitMesh(this.glContext),this.entities.push(t),this.SortEntities()}},{key:"RemoveEntity",value:function(t){var e=this.entities.findIndex((function(e){return e==t}));e>-1&&this.entities.splice(e,1),t.Release()}},{key:"SortEntities",value:function(){this.entities.sort((function(t,e){return t.zOrder<e.zOrder?-1:t.zOrder>e.zOrder?1:0}))}},{key:"StopTime",value:function(){this.stopTime=!0,this.time.deltaTime=0}},{key:"ResumeTime",value:function(){this.stopTime=!1}}]),o}(Lt);function Kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}var Ht=function(e){r(i,e);var n=Kt(i);function i(e){var r;return t(this,i),(r=n.call(this,e,"","")).rawVertexShader="\n        attribute vec4 vPosition;\n\n        uniform mat4 MVP;\n\n        void main() {\n            gl_Position = MVP * vPosition;\n        }\n        ",r.rawFragShader="\n        precision mediump float;\n\n        void main() {\n            gl_FragColor = vec4(1, 0.6, 0.4, 0.3);\n        }\n        ",r.CompileShader(),r}return i}($t);function Zt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}var Jt=function(e){r(i,e);var n=Zt(i);function i(e){var r;return t(this,i),(r=n.call(this)).verticies=[.5,.5,0,.5,-.5,0,-.5,.5,0,-.5,-.5,0],r.indices=[2,1,0,2,3,1],r.collisionBox=e,r}return d(i,[{key:"InitMesh",value:function(t){this.program=new Ht(t).program,f(a(i.prototype),"InitMesh",this).call(this,t),this.zOrder=1e3}},{key:"Render",value:function(){var t=this.collisionBox.GetScaledPoints(),e=t.scaledX1,n=t.scaledX2,r=t.scaledY1,i=t.scaledY2;this.verticies=[n,i,0,n,r,0,e,i,0,e,r,0],this.glContext.bindBuffer(this.glContext.ARRAY_BUFFER,this.vertexBuffer),this.glContext.bufferData(this.glContext.ARRAY_BUFFER,new Float32Array(this.verticies),this.glContext.STATIC_DRAW),this._SetRenderAttributes(),this._Draw()}}]),i}(Ut),Qt=function(){function e(n,r,i,o,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;t(this,e),this.entity=n,this.x=r,this.y=i,this.width=o,this.height=a,this.scale=s||new Rt(1,1,1),this.IsCollide=this.IsCollide.bind(this),this.GetScaledPoints=this.GetScaledPoints.bind(this),this.debugEntity=new Jt(this)}return d(e,[{key:"IsCollide",value:function(t){var e=this.GetScaledPoints(),n=t.GetScaledPoints(),r=e.scaledX1,i=e.scaledX2,o=e.scaledY1,a=e.scaledY2,s=n.scaledX1,u=n.scaledX2,c=n.scaledY1,l=n.scaledY2;return r<=u&&i>=s&&o<=l&&a>=c}},{key:"GetScaledPoints",value:function(){var t=this.entity.position[0]+this.x*this.scale[0],e=t+this.width*this.scale[0],n=this.entity.position[1]+this.y*this.scale[1];return{scaledX1:t,scaledX2:e,scaledY1:n,scaledY2:n+this.height*this.scale[1]}}}]),e}(),te=function(){function e(n){t(this,e),this.texture=null,this.image=null,this.src=n,this.imageLoadHanlder=null,this.width=0,this.height=0,this.glContext=null,this.InitTexture=this.InitTexture.bind(this),this.BindTexture=this.BindTexture.bind(this)}return d(e,[{key:"InitTexture",value:function(t){var e=this;this.glContext=t,this.texture=this.glContext.createTexture(),this.glContext.bindTexture(this.glContext.TEXTURE_2D,this.texture),this.glContext.texImage2D(this.glContext.TEXTURE_2D,0,this.glContext.RGBA,1,1,0,this.glContext.RGBA,this.glContext.UNSIGNED_BYTE,new Uint8Array([63,16,127,86])),this.image=new Image,this.image.src=this.src,this.image.addEventListener("load",(function(){e.width=e.image.width,e.height=e.image.height,e.glContext.bindTexture(e.glContext.TEXTURE_2D,e.texture),e.glContext.pixelStorei(e.glContext.UNPACK_FLIP_Y_WEBGL,!0),e.glContext.texImage2D(e.glContext.TEXTURE_2D,0,e.glContext.RGBA,e.glContext.RGBA,e.glContext.UNSIGNED_BYTE,e.image);var t=function(t){return 0==(t&t-1)};t(e.width)&&t(e.height)?(e.glContext.generateMipmap(e.glContext.TEXTURE_2D),e.glContext.texParameteri(e.glContext.TEXTURE_2D,e.glContext.TEXTURE_MIN_FILTER,e.glContext.NEAREST),e.glContext.texParameteri(e.glContext.TEXTURE_2D,e.glContext.TEXTURE_MAG_FILTER,e.glContext.NEAREST)):(e.glContext.texParameteri(e.glContext.TEXTURE_2D,e.glContext.TEXTURE_MAG_FILTER,e.glContext.LINEAR),e.glContext.texParameteri(e.glContext.TEXTURE_2D,e.glContext.TEXTURE_MIN_FILTER,e.glContext.LINEAR),e.glContext.texParameteri(e.glContext.TEXTURE_2D,e.glContext.TEXTURE_WRAP_S,e.glContext.CLAMP_TO_EDGE),e.glContext.texParameteri(e.glContext.TEXTURE_2D,e.glContext.TEXTURE_WRAP_T,e.glContext.CLAMP_TO_EDGE)),e.imageLoadHanlder&&e.imageLoadHanlder()}))}},{key:"BindTexture",value:function(){this.glContext.bindTexture(this.glContext.TEXTURE_2D,this.texture)}},{key:"Release",value:function(){this.texture&&this.glContext.deleteTexture(this.texture)}}]),e}();function ee(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ne(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ne(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function re(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}var ie=function(n){r(o,n);var i=re(o);function o(n){var r;return t(this,o),(r=i.call(this)).verticies=[.5,.5,0,.5,-.5,0,-.5,.5,0,-.5,-.5,0],r.indices=[2,1,0,2,3,1],r.texCoord=[1,1,1,0,0,1,0,0],r.texCoordBuffer=null,r.texCoordAttrLocation=null,r.textureUniformLocation=null,r.texture=new te(n),r.animTimer=0,r.curAnimIndex=0,r.animDelay=0,r.animationFrame=[],r.collisionBox=new Qt(e(r),-.5,-.5,1,1,r.scale),r.debugCollisionBox=!1,r}return d(o,[{key:"InitMesh",value:function(t){var e=this;this.program=new Xt(t).program,f(a(o.prototype),"InitMesh",this).call(this,t),this.texCoordAttrLocation=this.glContext.getAttribLocation(this.program,"vTexCoord"),this.texCoordBuffer=this.glContext.createBuffer(),this.glContext.bindBuffer(this.glContext.ARRAY_BUFFER,this.texCoordBuffer),this.glContext.bufferData(this.glContext.ARRAY_BUFFER,new Float32Array(this.texCoord),this.glContext.STATIC_DRAW),this.texture.imageLoadHanlder=function(){var t=e.texture.width,n=e.texture.height,r=t/2/t*(t/n),i=n/2/n;e.verticies=[r,i,0,r,-i,0,-r,i,0,-r,-i,0],e.glContext.bindBuffer(e.glContext.ARRAY_BUFFER,e.vertexBuffer),e.glContext.bufferData(e.glContext.ARRAY_BUFFER,new Float32Array(e.verticies),e.glContext.STATIC_DRAW),e.collisionBox.x=-r,e.collisionBox.y=-i,e.collisionBox.width=2*r,e.collisionBox.height=2*i},this.texture.InitTexture(t),this.textureUniformLocation=this.glContext.getUniformLocation(this.program,"texture"),this.debugCollisionBox&&(this.collisionBox.debugEntity.InitMesh(this.glContext),this.world.AddEntity(this.collisionBox.debugEntity))}},{key:"AddAnimation",value:function(t,e){this.animDelay=e;var n,r=ee(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=new te(i);o.InitTexture(this.glContext),this.animationFrame.push(o)}}catch(t){r.e(t)}finally{r.f()}}},{key:"Update",value:function(){f(a(o.prototype),"Update",this).call(this),this.world&&this.animationFrame.length&&(this.animTimer+=this.world.time.deltaTime,this.animTimer>this.animDelay&&(this.animTimer=0,this.curAnimIndex=(this.curAnimIndex+1)%this.animationFrame.length))}},{key:"Render",value:function(){this._SetRenderAttributes();(this.glContext.bindBuffer(this.glContext.ARRAY_BUFFER,this.texCoordBuffer),this.glContext.vertexAttribPointer(this.texCoordAttrLocation,2,this.glContext.FLOAT,!1,0,0),this.glContext.enableVertexAttribArray(this.texCoordAttrLocation),this.glContext.activeTexture(this.glContext.TEXTURE0),this.animationFrame.length)?this.animationFrame[this.curAnimIndex].BindTexture():this.texture.BindTexture();this.glContext.uniform1i(this.textureUniformLocation,0),this._Draw()}},{key:"Release",value:function(){if(f(a(o.prototype),"Release",this).call(this),this.texCoordBuffer&&this.glContext.deleteBuffer(this.texCoordBuffer),this.texture&&this.texture.Release(),this.animationFrame.length){var t,e=ee(this.animationFrame);try{for(e.s();!(t=e.n()).done;){t.value.Release()}}catch(t){e.e(t)}finally{e.f()}}}},{key:"Scale",value:function(t){f(a(o.prototype),"Scale",this).call(this,t),this.collisionBox.scale=this.scale}},{key:"ScaleX",value:function(t){f(a(o.prototype),"ScaleX",this).call(this,t),this.collisionBox.scale=this.scale}},{key:"ScaleY",value:function(t){f(a(o.prototype),"ScaleY",this).call(this,t),this.collisionBox.scale=this.scale}}]),o}(Ut);function oe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}var ae=function(e){r(i,e);var n=oe(i);function i(){var e;t(this,i);var r,o,a=(r=0,o=3,r=Math.ceil(r),o=Math.floor(o),Math.floor(Math.random()*(o-r))+r);return(e=n.call(this,"./images/bird_".concat(a,"_1.png"))).birdColor=a,e.velocity=new Rt(0,0,0),e.gravity=-4,e.jumpPower=3,e.canJump=!0,e}return d(i,[{key:"InitMesh",value:function(t){f(a(i.prototype),"InitMesh",this).call(this,t),this.Scale([.1,.1,.1]),this.AddAnimation(["./images/bird_".concat(this.birdColor,"_1.png"),"./images/bird_".concat(this.birdColor,"_2.png"),"./images/bird_".concat(this.birdColor,"_3.png")],.05)}},{key:"Update",value:function(){if(f(a(i.prototype),"Update",this).call(this),this.velocity.y+=this.gravity*this.world.time.deltaTime,(this.world.input.IsMouseClick()||this.world.input.IsKeyDown("Enter")||this.world.input.IsKeyDown(" "))&&this.canJump){if(this.velocity.y>this.jumpPower/10){var t=this.jumpPower/10/this.velocity.y;this.velocity.y+=this.jumpPower*t}else this.velocity.y+=this.jumpPower;this.canJump=!1}else this.world.input.IsMouseClick()||this.world.input.IsKeyDown("Enter")||this.world.input.IsKeyDown(" ")||(this.canJump=!0);this.TranslateY(this.position.y+this.velocity.y*this.world.time.deltaTime);var e=this.Lerp(-Math.PI/3,Math.PI/3,this.velocity.y);e=Math.min(Math.PI/3,Math.max(-Math.PI/3,e)),this.Rotate(e)}},{key:"Lerp",value:function(t,e,n){return(1-n)*t+n*e}}]),i}(ie);function se(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ue(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ue(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ue(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ce(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}var le=function(n){r(o,n);var i=ce(o);function o(){var n;return t(this,o),(n=i.call(this)).pipes=[],n.pipeSpawnHandler=null,n.pipeSpawnDelay=2500,n.backgroundSprite=new ie("./images/background_0.png"),n.grounds=[new ie("./images/ground.png"),new ie("./images/ground.png"),new ie("./images/ground.png")],n.bird=new ae,n.gameover=!1,n.score=0,n.PushPipe=n.PushPipe.bind(e(n)),n}return d(o,[{key:"SetUp",value:function(t){f(a(o.prototype),"SetUp",this).call(this,t),this.backgroundSprite.Scale([2,2,2]),this.AddEntity(this.backgroundSprite),this.backgroundSprite.AddAnimation(["./images/background_0.png","./images/background_1.png"],10);for(var e=0;e<this.grounds.length;e++)this.grounds[e].Scale([.4,.4,.4]),this.grounds[e].TranslateY(-1.05),this.grounds[e].SetZOrder(10),e>0&&this.grounds[e].TranslateX(this.grounds[e-1].position.x+1.1),this.AddEntity(this.grounds[e]);this.bird.TranslateX(-.3),this.AddEntity(this.bird),this.pipeSpawnHandler=setInterval(this.PushPipe,this.pipeSpawnDelay),this.PushPipe()}},{key:"Update",value:function(){f(a(o.prototype),"Update",this).call(this),this.gameover&&(this.StopTime(),clearInterval(this.pipeSpawnHandler));var t,e=se(this.pipes);try{for(e.s();!(t=e.n()).done;){var n=t.value,r=n[0],i=n[1];r.TranslateX(r.position.x-.4*this.time.deltaTime),i.TranslateX(i.position.x-.4*this.time.deltaTime),r.position.x<-1&&(this.RemoveEntity(n[0]),this.RemoveEntity(n[1]),this.pipes.splice(0,1),this.score++)}}catch(t){e.e(t)}finally{e.f()}for(var s=0;s<this.grounds.length;s++)this.grounds[s].TranslateX(this.grounds[s].position.x-.4*this.time.deltaTime),this.grounds[s].position.x<-1.1&&this.grounds[s].TranslateX(this.grounds[(s+1)%this.grounds.length].position.x+1.1);this.bird.position.y<-1.05&&(this.gameover=!0);var u,c=se(this.pipes);try{for(c.s();!(u=c.n()).done;){var l=u.value;(l[0].collisionBox.IsCollide(this.bird.collisionBox)||l[1].collisionBox.IsCollide(this.bird.collisionBox))&&(this.gameover=!0)}}catch(t){c.e(t)}finally{c.f()}}},{key:"PushPipe",value:function(){var t=this.score>10?1:0,e=new ie("./images/pipe_".concat(t,"_up.png")),n=new ie("./images/pipe_".concat(t,"_down.png"));e.Scale([1.5,1.5,1.5]),n.Scale([1.5,1.5,1.5]),e.TranslateX(1.5),n.TranslateX(1.5);var r=this.getRandomArbitrary(-.3,.3);e.TranslateY(-1.1+r),n.TranslateY(1.1+r),this.AddEntity(e),this.AddEntity(n),this.pipes.push([e,n])}},{key:"getRandomArbitrary",value:function(t,e){return Math.random()*(e-t)+t}}]),o}(Gt);function he(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function fe(t){var e,n,r,i,o,a;return{c:function(){e=b("div"),(n=b("div")).innerHTML='<p class="svelte-2zjwc2">Mouse Left Click or</p> \n\t\t<p class="svelte-2zjwc2">Keyboard Enter(Return) or</p> \n\t\t<p class="svelte-2zjwc2">Keyboard Space is Jump!</p>',r=T(),i=b("canvas"),o=T(),a=b("div"),w(n,"class","control svelte-2zjwc2"),w(i,"width",t[1]),w(i,"height",t[2]),w(i,"class","svelte-2zjwc2"),w(a,"class","dummy"),w(e,"class","game-canvas svelte-2zjwc2")},m:function(s,u){R(s,e,u),E(e,n),E(e,r),E(e,i),t[5](i),E(e,o),E(e,a)},p:y,i:y,o:y,d:function(n){n&&C(e),t[5](null)}}}function ve(t,e,n){var r,i=new le;P((function(){for(var t=null,e=0,o=["webgl","experimental-webgl","webkit-3d","moz-webgl"];e<o.length;e++){var s=o[e];if(t=r.getContext(s))break}t||console.log("GL Context가 없음!"),i.SetUp(t);!function t(){i.Update(),i.Render(),n(3,a=i.score),n(4,u=i.gameover),requestAnimationFrame(t)}()}));var o=e.score,a=void 0===o?0:o,s=e.gameover,u=void 0!==s&&s;return t.$$set=function(t){"score"in t&&n(3,a=t.score),"gameover"in t&&n(4,u=t.gameover)},[r,286,512,a,u,function(t){B[t?"unshift":"push"]((function(){n(0,r=t)}))}]}var de=function(n){r(o,n);var i=he(o);function o(n){var r;return t(this,o),Z(e(r=i.call(this)),n,ve,fe,k,{score:3,gameover:4}),r}return o}(J);function ye(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function pe(t){var e;return{c:function(){(e=b("div")).innerHTML='<p class="svelte-1chm3f0">Gameover!</p>',w(e,"class","gameover svelte-1chm3f0")},m:function(t,n){R(t,e,n)},d:function(t){t&&C(e)}}}function ge(t){var e,n,r,i,o,a,s,u,l,h,f,v,d,y,p,g,m;function x(e){t[3](e)}function k(e){t[4](e)}var A={};void 0!==t[1]&&(A.score=t[1]),void 0!==t[2]&&(A.gameover=t[2]),d=new de({props:A}),B.push((function(){return V(d,"score",x)})),B.push((function(){return V(d,"gameover",k)}));var _=t[2]&&pe();return{c:function(){var c;e=b("main"),n=b("div"),r=b("p"),i=S("Max Score : "),o=S(t[0]),a=T(),s=b("div"),u=b("p"),l=S("Score : "),h=S(t[1]),f=T(),v=b("div"),(c=d.$$.fragment)&&c.c(),g=T(),_&&_.c(),w(r,"class","svelte-1chm3f0"),w(n,"class","max-score svelte-1chm3f0"),w(u,"class","svelte-1chm3f0"),w(s,"class","score svelte-1chm3f0"),w(v,"class","game-container")},m:function(t,c){R(t,e,c),E(e,n),E(n,r),E(r,i),E(r,o),E(e,a),E(e,s),E(s,u),E(u,l),E(u,h),E(e,f),E(e,v),G(d,v,null),E(e,g),_&&_.m(e,null),m=!0},p:function(t,n){var r=c(n,1)[0];(!m||1&r)&&M(o,t[0]),(!m||2&r)&&M(h,t[1]);var i={};!y&&2&r&&(y=!0,i.score=t[1],$((function(){return y=!1}))),!p&&4&r&&(p=!0,i.gameover=t[2],$((function(){return p=!1}))),d.$set(i),t[2]?_||((_=pe()).c(),_.m(e,null)):_&&(_.d(1),_=null)},i:function(t){m||(q(d.$$.fragment,t),m=!0)},o:function(t){!function(t,e,n,r){if(t&&t.o){if(W.has(t))return;W.add(t),(void 0).c.push((function(){W.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}(d.$$.fragment,t),m=!1},d:function(t){t&&C(e),K(d),_&&_.d()}}}function me(t,e,n){var r=0,i=0,o=!1;return P((function(){n(0,r=parseInt(localStorage.getItem("maxScore")||"0"))})),t.$$.update=function(){7&t.$$.dirty&&o&&r<i&&localStorage.setItem("maxScore",i.toString())},[r,i,o,function(t){n(1,i=t)},function(t){n(2,o=t)}]}return new(function(n){r(o,n);var i=ye(o);function o(n){var r;return t(this,o),Z(e(r=i.call(this)),n,me,ge,k,{}),r}return o}(J))({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
